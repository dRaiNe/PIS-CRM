<ui:composition template="/index.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">

    <ui:define name="title">
        Zaměstnanci
    </ui:define>

    <ui:define name="content">
<h:form id="form">
	<p:growl id="msgs"/>
	
    <h1>Zaměstnanci</h1>
    <ui:param name="activeTab" value="2" />
    
    <style type="text/css">
        .ui-chkbox .ui-chkbox-box {margin-right: 5px;}
    </style> 
 	   <p:dataTable id="itemtable"  var="item" value="#{employeesBean.employees}"  editable="true" editMode="cell"  style="margin-bottom:40px">
 	   <p:ajax event="cellEdit" listener="#{employeesBean.onCellEdit}" update=":form:msgs :form:itemtable" />
 	   
        <p:column headerText="Id" sortBy="#{item.id}">
            <h:outputText value="#{item.id}" />
        </p:column>

        <p:column headerText="Login" sortBy="#{item.login}">
            <h:outputText value="#{item.login}" />
        </p:column>

        <p:column headerText="Titul" sortBy="#{item.degree}">
         <p:cellEditor>
            <f:facet name="output"><h:outputText value="#{item.degree}" /></f:facet>
            <f:facet name="input"><p:inputText value="#{item.degree}" style="width:100%"/></f:facet>
         </p:cellEditor>
        </p:column>
 
        <p:column headerText="Jméno" sortBy="#{item.name}">
         <p:cellEditor>
            <f:facet name="output"><h:outputText value="#{item.name}" /></f:facet>
            <f:facet name="input"><p:inputText value="#{item.name}" style="width:100%"/></f:facet>
         </p:cellEditor>
        </p:column>
 
        <p:column headerText="Přijmení" sortBy="#{item.surname}">
          <p:cellEditor>
            <f:facet name="output"><h:outputText value="#{item.surname}" /></f:facet>
            <f:facet name="input"><p:inputText value="#{item.surname}" style="width:100%"/></f:facet>
          </p:cellEditor>
        </p:column>
 
        <p:column headerText="Oprávnění" sortBy="#{item.type}">
          <p:cellEditor>
            <f:facet name="output"><h:outputText value="#{item.typeString}" /></f:facet>
            <f:facet name="input">
				<h:selectOneMenu value="#{item.type}" style="width:100%">
                        <f:selectItems value="#{employeesBean.types}" var="type" itemLabel="#{type}" itemValue="#{type}" />
                </h:selectOneMenu>
			</f:facet>
          </p:cellEditor>
        </p:column>
        
 		 <p:column headerText="Specialista na" sortBy="#{item.specialistToBrandsString}">
          <p:cellEditor>
            <f:facet name="output"><h:outputText value="#{item.specialistToBrandsString}" /></f:facet>
            <f:facet name="input">
				<p:selectManyMenu value="#{item.specialistToBrands}"  showCheckbox="true">
            		<f:selectItems value="#{employeesBean.carBrands}" var="brand" itemLabel="#{brand.name}" itemValue="#{brand}" /> 
        		</p:selectManyMenu>
			</f:facet>
          </p:cellEditor>
        </p:column>
        
        <p:column style="width:60px;text-align:center;" headerText="Zákazníků">
        	<h:outputText value="#{item.customers.size()}" />
        </p:column>
        
 		<p:column style="width:60px">
            <p:commandButton value="Smazat"  onclick="return window.confirm('Opravdu smazat?')" update=":form:msgs :form:itemtable" icon="ui-icon-close" action="#{employeesBean.delete(item)}"/>
        </p:column>
        
    </p:dataTable>
  </h:form>
      
     <div class="ui-g">
         <div class="ui-g-12">
				<h:link outcome="AddEmployee"><button class="ui-button ui-widget ui-state-default ui-corner-all" style="padding:10px" >Přidat zaměstnance</button></h:link>				         
         </div>
     </div>
    
</ui:define>
</ui:composition>